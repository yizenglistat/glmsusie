% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Rinternal.R
\name{single_effect_fit}
\alias{single_effect_fit}
\title{Single-Effect Screening (GLM / Cox)}
\arguments{
\item{X}{An \eqn{n \times p} numeric matrix of predictors.}

\item{y}{For GLM: numeric vector of length \eqn{n}. For Cox: either an
\eqn{n \times 2} matrix \code{(time, status)} or a list \code{list(time, status)}.}

\item{family}{GLM family object (e.g., \code{binomial()}, \code{gaussian()},
\code{poisson()}), or the string \code{"cox"} to use Cox PH.}

\item{offset}{Optional numeric vector of length \eqn{n}, or scalar; if scalar,
it is expanded to length \eqn{n}.}

\item{standardize}{Logical, kept for API compatibility (inner fits use R modeling).}

\item{shrinkage}{Logical; if \code{TRUE}, zero out \code{expect_*} entries when the
corresponding LRT p-value exceeds \code{alpha}.}

\item{ties}{Cox ties handling: \code{"efron"} (default) or \code{"breslow"}.}

\item{lambda, tau}{Numeric; kept for API compatibility (not used by glm/cox wrappers).}

\item{alpha}{Numeric in (0,1); significance level for shrinkage tests (default 0.05).}
}
\value{
A list with components (all length \eqn{p} unless noted):
\itemize{
\item \code{loglik}: log-likelihood for each single-variable model.
\item \code{bic}: BIC of each single-variable model.
\item \code{bic_diff}: \code{BIC1 - BIC0} (global null BIC).
\item \code{bf}: Bayes factors via stabilized \code{exp(0.5 * evidence)}.
\item \code{pmp}: posterior model probabilities (softmax over evidence).
\item \code{intercept}: intercept estimates (0 for Cox).
\item \code{theta}: slope estimates from univariate fits.
\item \code{se_theta}: standard errors of \code{theta}.
\item \code{pval_raw}: Wald (GLM) or LRT (Cox) p-values from univariate fits.
\item \code{pval_intercept}: LRT p-values for intercept (expectation test).
\item \code{pval_theta}: LRT p-values for slope (expectation test).
\item \code{evidence}: \code{twoLogBF â‰ˆ BIC0 - BIC1} per variable.
\item \code{evidence_raw}: same as \code{evidence} (kept for compatibility).
\item \code{expect_intercept}: PMP-weighted intercept per variable (post-shrinkage).
\item \code{expect_theta}: PMP-weighted slope per variable (post-shrinkage).
\item \code{expect_variance}: scalar \code{Var_pmp(theta)}.
}
}
\description{
For each column of \code{X}, fits a univariate model (GLM via \code{stats::glm()}
or Cox PH via \code{survival::coxph()}, selected by \code{family}), computes
per-variable statistics (coef, SE, p-values, BIC, evidence), converts
BIC-based evidence to Bayes factors and posterior model probabilities (PMP)
using a numerically stable softmax, and optionally applies shrinkage tests
using likelihood-ratio tests on the expected coefficients.
}
\examples{
set.seed(1)
n <- 200; p <- 5
X <- matrix(rnorm(n*p), n, p)
beta <- c(1, 0, 0.5, 0, 0)
eta  <- 0.2 + X \%*\% beta
y    <- rbinom(n, 1, plogis(eta))
out  <- single_effect_fit(X, y, binomial(), offset = rep(0, n))
str(out$pmp)

}
