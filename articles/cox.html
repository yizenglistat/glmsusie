<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cox Regression with Correlated Predictors • glmsusie</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Cox Regression with Correlated Predictors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmsusie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">About</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/tags.html">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yizenglistat/glmsusie"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:yizenglistat@gmail.com"><span class="fa fa-solid fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/your-paper-doi"><span class="fa fa-solid fa-book"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cox Regression with Correlated Predictors</h1>
                        <h4 data-toc-skip class="author">Yizeng Li</h4>
            
            <h4 data-toc-skip class="date">2025-10-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yizenglistat/glmsusie/blob/main/vignettes/cox.Rmd" class="external-link"><code>vignettes/cox.Rmd</code></a></small>
      <div class="d-none name"><code>cox.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>glmsusie</strong> package implements the generalized sum
of single effects (gSuSiE) model, which represents the overall effect as
a sum of a small number of <em>single-effect</em> components. This
approach extends variable selection to various regression models
including Cox proportional hazards regression for survival analysis.</p>
<p>In this vignette, we demonstrate gSuSiE’s performance with survival
outcomes and highly correlated predictors:</p>
<ul>
<li>Simulate a block-wise correlation structure with 100 predictors</li>
<li>Apply gSuSiE to perform variable selection via
<code><a href="../reference/glmsusie.html">glmsusie()</a></code> with Cox regression</li>
<li>Visualize coefficient estimates, posterior inclusion probabilities
(PIPs), and credible sets (CSs)</li>
<li>Evaluate predictive performance for survival analysis</li>
</ul>
</div>
<div class="section level2">
<h2 id="simulate-data">Simulate data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h2>
<p>We generate <span class="math inline">n=1000</span> observations and
<span class="math inline">p=100</span> predictors with block-wise
correlation. Every 10 consecutive variables are highly correlated (<span class="math inline">\rho=0.95</span>) within each block, while blocks
are independent. Only 4 variables have nonzero effects on the hazard,
located in different correlation blocks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>     <span class="co"># sample size</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span>      <span class="co"># number of predictors</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">10</span>       <span class="co"># number of single-effect components</span></span>
<span><span class="va">block_size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n_blocks</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">/</span> <span class="va">block_size</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.95</span>    <span class="co"># within-block correlation</span></span>
<span></span>
<span><span class="co"># Create block-wise correlation matrix</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_blocks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">block_idx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">block_size</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">b</span><span class="op">*</span><span class="va">block_size</span><span class="op">)</span></span>
<span>  <span class="co"># Within-block correlation matrix</span></span>
<span>  <span class="va">block_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">block_size</span>, <span class="va">block_size</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">block_corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">Sigma</span><span class="op">[</span><span class="va">block_idx</span>, <span class="va">block_idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">block_corr</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generate correlated predictors</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True sparse coefficients (one per block, spread across different blocks)</span></span>
<span><span class="va">theta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_true</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">18</span>, <span class="fl">47</span>, <span class="fl">82</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate survival data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="va">linear_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_true</span><span class="op">)</span></span>
<span><span class="va">hazard_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">linear_pred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate survival times from exponential distribution</span></span>
<span><span class="va">lambda_baseline</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">survival_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="va">lambda_baseline</span> <span class="op">*</span> <span class="va">hazard_ratio</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate censoring times (administrative censoring)</span></span>
<span><span class="va">censor_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed times and event indicators</span></span>
<span><span class="va">observed_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">survival_times</span>, <span class="va">censor_times</span><span class="op">)</span></span>
<span><span class="va">event_indicator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">survival_times</span> <span class="op">&lt;=</span> <span class="va">censor_times</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create survival object</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">observed_times</span>, <span class="va">event_indicator</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True nonzero coefficients at positions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## True nonzero coefficients at positions: 3 18 47 82</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True coefficient values:"</span>, <span class="va">theta_true</span><span class="op">[</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## True coefficient values: 1 -1 1 -1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Event rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">event_indicator</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## Event rate: 0.608</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Median follow-up time:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">observed_times</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## Median follow-up time: 4.682838</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-gsusie-model">Fit gSuSiE model<a class="anchor" aria-label="anchor" href="#fit-gsusie-model"></a>
</h2>
<p>We allow up to <span class="math inline">L=10</span> single effects
and use the Cox family for survival regression. The method is robust to
larger <span class="math inline">L</span> values with minimal
overfitting risk.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load glmsusie library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yizenglistat/glmsusie" class="external-link">glmsusie</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model fitting</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmsusie.html">glmsusie</a></span><span class="op">(</span></span>
<span>  X      <span class="op">=</span> <span class="va">X</span>,</span>
<span>  y      <span class="op">=</span> <span class="va">y</span>,</span>
<span>  L      <span class="op">=</span> <span class="va">L</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="../reference/cox.html">cox</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glmsusie(X = X, y = y, L = L, family = cox())</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family: cox </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: (sorted by PIP)</span></span>
<span><span class="co">##         Estimate    PIP</span></span>
<span><span class="co">## X47  0.901898999 1.0000</span></span>
<span><span class="co">## X82 -0.852089479 1.0000</span></span>
<span><span class="co">## X18 -0.874196084 1.0000</span></span>
<span><span class="co">## X3   0.810845532 1.0000</span></span>
<span><span class="co">## X7   0.064899968 0.3493</span></span>
<span><span class="co">## X9   0.053064353 0.2864</span></span>
<span><span class="co">## X2   0.019897998 0.1139</span></span>
<span><span class="co">## X5   0.008076569 0.0493</span></span>
<span><span class="co">## X1   0.007753359 0.0479</span></span>
<span><span class="co">## X4   0.007636828 0.0464</span></span>
<span><span class="co">## ... (90 more coefficients not shown)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 95% Confidence Sets:</span></span>
<span><span class="co">##                          Set Coverage</span></span>
<span><span class="co">## cs1                     {82}   1.0000</span></span>
<span><span class="co">## cs2                      {3}   1.0000</span></span>
<span><span class="co">## cs3                     {47}   1.0000</span></span>
<span><span class="co">## cs4                     {18}   1.0000</span></span>
<span><span class="co">## cs5 {1, 2, 3, 4, 5, 6, 7, 9}   0.9517</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model converged after 3 iterations.</span></span>
<span><span class="co">## Computation time: 90.57 seconds.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="coefficient-estimates">Coefficient estimates<a class="anchor" aria-label="anchor" href="#coefficient-estimates"></a>
</h3>
<p>The method successfully identifies the true signal locations despite
high correlation within blocks:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cox_files/figure-html/coef-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="posterior-inclusion-probabilities">Posterior inclusion probabilities<a class="anchor" aria-label="anchor" href="#posterior-inclusion-probabilities"></a>
</h3>
<p>Shows the probability that each variable is included in any
single-effect component:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"probabilities"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cox_files/figure-html/prob-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="credible-sets">95% credible sets<a class="anchor" aria-label="anchor" href="#credible-sets"></a>
</h3>
<p>Each credible set contains variables where at least one is likely
active with 95% confidence. Note how the method handles correlated
variables within blocks:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"sets"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cox_files/figure-html/cs-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="credible-sets-summary">Credible sets summary<a class="anchor" aria-label="anchor" href="#credible-sets-summary"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of credible sets</span></span>
<span><span class="va">cs_sets</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">cs</span><span class="op">$</span><span class="va">sets</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cs_sets</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of credible sets:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cs_sets</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cs_sets</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CS"</span>, <span class="va">i</span>, <span class="st">"contains variables:"</span>, <span class="va">cs_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check coverage of true variables</span></span>
<span>  <span class="va">true_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">covered_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">cs_sets</span><span class="op">)</span>, <span class="va">true_vars</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTrue variables covered by credible sets:"</span>, <span class="va">covered_vars</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No credible sets identified\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">## Number of credible sets: 5 </span></span>
<span><span class="co">## CS 1 contains variables: 82 </span></span>
<span><span class="co">## CS 2 contains variables: 3 </span></span>
<span><span class="co">## CS 3 contains variables: 47 </span></span>
<span><span class="co">## CS 4 contains variables: 18 </span></span>
<span><span class="co">## CS 5 contains variables: 1 2 3 4 5 6 7 9 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## True variables covered by credible sets: 82 3 47 18</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="coefficient-comparison">Coefficient comparison<a class="anchor" aria-label="anchor" href="#coefficient-comparison"></a>
</h3>
<p>Compare estimated coefficients with true values:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract coefficients</span></span>
<span><span class="va">coef_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Variable <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span>,</span>
<span>  True_Coef <span class="op">=</span> <span class="va">theta_true</span>,</span>
<span>  Estimated_Coef <span class="op">=</span> <span class="va">coef_est</span>,</span>
<span>  PIP <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">pip</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results for true active variables</span></span>
<span><span class="va">active_comparison</span> <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">[</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">active_comparison</span><span class="op">)</span></span>
<span><span class="co">##     Variable True_Coef Estimated_Coef       PIP</span></span>
<span><span class="co">## X3         3         1      0.8108455 0.9999920</span></span>
<span><span class="co">## X18       18        -1     -0.8741961 0.9999999</span></span>
<span><span class="co">## X47       47         1      0.9018990 1.0000000</span></span>
<span><span class="co">## X82       82        -1     -0.8520895 1.0000000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This example demonstrates that gSuSiE effectively handles Cox
proportional hazards regression with highly correlated predictors. The
method identifies relevant variables even when they are embedded within
correlation blocks, providing both point estimates and uncertainty
quantification through credible sets. The Cox family implementation
successfully recovers the sparse signal structure in survival data while
properly handling censoring and the semi-parametric nature of the Cox
model.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yizeng Li, Wei Pan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
