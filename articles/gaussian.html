<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Gaussian Linear Regression with Correlated Predictors • glmsusie</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Gaussian Linear Regression with Correlated Predictors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmsusie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">About</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/tags.html">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yizenglistat/glmsusie"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:yizenglistat@gmail.com"><span class="fa fa-solid fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/your-paper-doi"><span class="fa fa-solid fa-book"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gaussian Linear Regression with Correlated Predictors</h1>
                        <h4 data-toc-skip class="author">Yizeng Li</h4>
            
            <h4 data-toc-skip class="date">2025-10-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yizenglistat/glmsusie/blob/main/vignettes/gaussian.Rmd" class="external-link"><code>vignettes/gaussian.Rmd</code></a></small>
      <div class="d-none name"><code>gaussian.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>glmsusie</strong> package implements the generalized sum
of single effects (gSuSiE) model, which represents the overall effect as
a sum of a small number of <em>single-effect</em> components. This
approach extends the <a href="https://stephenslab.github.io/susieR/index.html" class="external-link">SuSiE method</a>
to generalized linear models.</p>
<p>In this vignette, we demonstrate gSuSiE’s performance with highly
correlated predictors:</p>
<ul>
<li>Simulate a block-wise correlation structure with 100 predictors</li>
<li>Apply gSuSiE to perform variable selection via
<code><a href="../reference/glmsusie.html">glmsusie()</a></code>
</li>
<li>Visualize coefficient estimates, posterior inclusion probabilities
(PIPs), and credible sets (CSs)</li>
<li>Compare performance against <a href="https://stephenslab.github.io/susieR/index.html" class="external-link">SuSiE</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="simulate-data">Simulate data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h2>
<p>We generate <span class="math inline">n=5000</span> observations and
<span class="math inline">p=100</span> predictors with block-wise
correlation. Every 10 consecutive variables are highly correlated (<span class="math inline">\rho=0.98</span>) within each block, while blocks
are independent. Only 4 variables have nonzero effects, located in
different correlation blocks.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span>     <span class="co"># sample size</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">100</span>     <span class="co"># number of predictors</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fl">10</span>      <span class="co"># number of single-effect components</span></span>
<span><span class="va">block_size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n_blocks</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">/</span> <span class="va">block_size</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.98</span>   <span class="co"># within-block correlation</span></span>
<span></span>
<span><span class="co"># Create block-wise correlation matrix</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_blocks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">block_idx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">b</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">block_size</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">b</span><span class="op">*</span><span class="va">block_size</span><span class="op">)</span></span>
<span>  <span class="co"># Within-block correlation matrix</span></span>
<span>  <span class="va">block_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">rho</span>, <span class="va">block_size</span>, <span class="va">block_size</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">block_corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">Sigma</span><span class="op">[</span><span class="va">block_idx</span>, <span class="va">block_idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">block_corr</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generate correlated predictors</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True sparse coefficients (one per block, spread across different blocks)</span></span>
<span><span class="va">theta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_true</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">18</span>, <span class="fl">47</span>, <span class="fl">82</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate response</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_true</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True nonzero coefficients at positions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## True nonzero coefficients at positions: 3 18 47 82</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True coefficient values:"</span>, <span class="va">theta_true</span><span class="op">[</span><span class="va">theta_true</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## True coefficient values: 1 -1 1 -1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-gsusie-model">Fit gSuSiE model<a class="anchor" aria-label="anchor" href="#fit-gsusie-model"></a>
</h2>
<p>We allow up to <span class="math inline">L=10</span> single effects
and use the default Gaussian family. The method is robust to larger
<span class="math inline">L</span> values with minimal overfitting
risk.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load glmsusie library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yizenglistat/glmsusie" class="external-link">glmsusie</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model fitting</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glmsusie.html">glmsusie</a></span><span class="op">(</span></span>
<span>  X      <span class="op">=</span> <span class="va">X</span>,</span>
<span>  y      <span class="op">=</span> <span class="va">y</span>,</span>
<span>  L      <span class="op">=</span> <span class="va">L</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glmsusie(X = X, y = y, L = L, family = gaussian())</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients: (sorted by PIP)</span></span>
<span><span class="co">##        Estimate    PIP</span></span>
<span><span class="co">## X82 -1.00455847 0.9999</span></span>
<span><span class="co">## X47  0.99552173 0.9994</span></span>
<span><span class="co">## X18 -0.90263767 0.9849</span></span>
<span><span class="co">## X3   0.58003843 0.8059</span></span>
<span><span class="co">## X4   0.08666866 0.2506</span></span>
<span><span class="co">## X5   0.05426638 0.1618</span></span>
<span><span class="co">## X1   0.04286195 0.1436</span></span>
<span><span class="co">## X10  0.03441246 0.1262</span></span>
<span><span class="co">## X6   0.03396987 0.1241</span></span>
<span><span class="co">## X2   0.03030643 0.1160</span></span>
<span><span class="co">## ... (90 more coefficients not shown)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 95% Confidence Sets:</span></span>
<span><span class="co">##                              Set Coverage</span></span>
<span><span class="co">## cs1                         {82}   0.9999</span></span>
<span><span class="co">## cs2              {1, 3, 4, 5, 6}   0.9537</span></span>
<span><span class="co">## cs3 {1, 2, 3, 4, 5, 6, 7, 9, 10}   0.9597</span></span>
<span><span class="co">## cs4                         {47}   0.9994</span></span>
<span><span class="co">## cs5                         {18}   0.9849</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model converged after 3 iterations.</span></span>
<span><span class="co">## Computation time: 15.95 seconds.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="coefficient-estimates">Coefficient estimates<a class="anchor" aria-label="anchor" href="#coefficient-estimates"></a>
</h3>
<p>The method successfully identifies the true signal locations despite
high correlation within blocks:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gaussian_files/figure-html/coef-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="posterior-inclusion-probabilities">Posterior inclusion probabilities<a class="anchor" aria-label="anchor" href="#posterior-inclusion-probabilities"></a>
</h3>
<p>Shows the probability that each variable is included in any
single-effect component:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"probabilities"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gaussian_files/figure-html/prob-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="credible-sets">95% credible sets<a class="anchor" aria-label="anchor" href="#credible-sets"></a>
</h3>
<p>Each credible set contains variables where at least one is likely
active with 95% confidence. Note how the method handles correlated
variables within blocks:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"sets"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gaussian_files/figure-html/cs-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="performance-evaluation">Performance evaluation<a class="anchor" aria-label="anchor" href="#performance-evaluation"></a>
</h3>
<p>Compare predictive performance between methods:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prediction performance</span></span>
<span><span class="va">rmse_glmsusie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare with SuSiE</span></span>
<span><span class="va">fit_susie</span> <span class="op">&lt;-</span> <span class="fu">susieR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/susieR/man/susie.html" class="external-link">susie</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, L <span class="op">=</span> <span class="va">L</span><span class="op">)</span></span>
<span><span class="va">fitted_susie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit_susie</span><span class="op">)</span></span>
<span><span class="va">rmse_susie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">fitted_susie</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">performance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SuSiE"</span>, <span class="st">"gSuSiE"</span><span class="op">)</span>,</span>
<span>  RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rmse_susie</span>, <span class="va">rmse_glmsusie</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">performance</span><span class="op">)</span></span>
<span><span class="co">##   Method     RMSE</span></span>
<span><span class="co">## 1  SuSiE 3.008832</span></span>
<span><span class="co">## 2 gSuSiE 3.009038</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="susie-credible-sets-comparison">SuSiE credible sets comparison<a class="anchor" aria-label="anchor" href="#susie-credible-sets-comparison"></a>
</h3>
<p>Examine the credible sets identified by SuSiE:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SuSiE credible sets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SuSiE Credible Sets:\n"</span><span class="op">)</span></span>
<span><span class="co">## SuSiE Credible Sets:</span></span>
<span><span class="va">susie_sets</span> <span class="op">&lt;-</span> <span class="va">fit_susie</span><span class="op">$</span><span class="va">sets</span><span class="op">$</span><span class="va">cs</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cs_vars</span> <span class="op">&lt;-</span> <span class="va">susie_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">cs_pips</span> <span class="op">&lt;-</span> <span class="va">fit_susie</span><span class="op">$</span><span class="va">pip</span><span class="op">[</span><span class="va">cs_vars</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Format variables with their PIPs</span></span>
<span>    <span class="va">var_pip_strings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">cs_vars</span>, <span class="st">" (PIP: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cs_pips</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"contains variables:"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">var_pip_strings</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No credible sets identified by SuSiE\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">## CS L1 contains variables: 82 (PIP: 0.9999) </span></span>
<span><span class="co">## CS L2 contains variables: 47 (PIP: 0.9994) </span></span>
<span><span class="co">## CS L4 contains variables: 18 (PIP: 0.9848) </span></span>
<span><span class="co">## CS L3 contains variables: 3 (PIP: 0.7468), 4 (PIP: 0.2041), 5 (PIP: 0.028)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-susie-credible-sets">Visualize SuSiE credible sets<a class="anchor" aria-label="anchor" href="#visualize-susie-credible-sets"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create matrix for SuSiE credible sets visualization</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create probability matrix for credible sets</span></span>
<span>  <span class="va">susie_cs_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cs_vars</span> <span class="op">&lt;-</span> <span class="va">susie_sets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="co"># Use PIPs as probabilities for variables in the credible set</span></span>
<span>    <span class="va">susie_cs_matrix</span><span class="op">[</span><span class="va">i</span>, <span class="va">cs_vars</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_susie</span><span class="op">$</span><span class="va">pip</span><span class="op">[</span><span class="va">cs_vars</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Plot SuSiE credible sets using our plotting function</span></span>
<span>  <span class="fu"><a href="../reference/plot_cs_matrix.html">plot_cs_matrix</a></span><span class="op">(</span><span class="va">susie_cs_matrix</span>, </span>
<span>                 row_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SuSiE CS_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">susie_sets</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No SuSiE credible sets to visualize\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="gaussian_files/figure-html/susie_cs_plot-1.png" width="875" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This example demonstrates that gSuSiE effectively handles very highly
correlated predictors. The method identifies informative variables even
when they are embedded within correlation blocks, providing both point
estimates and uncertainty quantification through credible sets.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yizeng Li, Wei Pan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
