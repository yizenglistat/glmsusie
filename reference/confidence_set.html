<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct Confidence Sets from Posterior Model Probabilities — confidence_set • glmsusie</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Construct Confidence Sets from Posterior Model Probabilities — confidence_set"><meta name="description" content="For each latent effect (column) in a posterior model probability matrix pmp,
select the smallest set of variables whose cumulative probability reaches at least
coverage.  Optionally filter out sets whose minimum absolute pairwise
correlation (from Rmat) is below cor_threshold, and remove duplicates."><meta property="og:description" content="For each latent effect (column) in a posterior model probability matrix pmp,
select the smallest set of variables whose cumulative probability reaches at least
coverage.  Optionally filter out sets whose minimum absolute pairwise
correlation (from Rmat) is below cor_threshold, and remove duplicates."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmsusie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">About</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/tags.html">Tags</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/yizenglistat/glmsusie"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../mailto:yizenglistat@gmail.com"><span class="fa fa-solid fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/your-paper-doi"><span class="fa fa-solid fa-book"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct Confidence Sets from Posterior Model Probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/yizenglistat/glmsusie/blob/main/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>confidence_set.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each latent effect (column) in a posterior model probability matrix <code>pmp</code>,
select the smallest set of variables whose cumulative probability reaches at least
<code>coverage</code>.  Optionally filter out sets whose minimum absolute pairwise
correlation (from <code>Rmat</code>) is below <code>cor_threshold</code>, and remove duplicates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span>, coverage <span class="op">=</span> <span class="fl">0.95</span>, Rmat <span class="op">=</span> <span class="cn">NULL</span>, cor_threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pmp">pmp<a class="anchor" aria-label="anchor" href="#arg-pmp"></a></dt>
<dd><p>Numeric matrix of dimension \(p \times L\), where each column sums to 1
and contains posterior inclusion probabilities for each variable and effect.</p></dd>


<dt id="arg-kept">kept<a class="anchor" aria-label="anchor" href="#arg-kept"></a></dt>
<dd><p>Logical vector of length \(L\), indicating which effects (columns) to process.</p></dd>


<dt id="arg-coverage">coverage<a class="anchor" aria-label="anchor" href="#arg-coverage"></a></dt>
<dd><p>Numeric scalar in [0,1], the target cumulative probability for a confidence set.
Defaults to 0.95.</p></dd>


<dt id="arg-rmat">Rmat<a class="anchor" aria-label="anchor" href="#arg-rmat"></a></dt>
<dd><p>Optional \(p \times p\) numeric correlation matrix for the predictors.
If supplied, any set whose minimum off-diagonal absolute correlation is below
<code>cor_threshold</code> is discarded.  Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-cor-threshold">cor_threshold<a class="anchor" aria-label="anchor" href="#arg-cor-threshold"></a></dt>
<dd><p>Numeric scalar in [0,1], the minimum absolute correlation allowed
within a set to pass the correlation filter.  Defaults to 0.5.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt><code>sets</code></dt>
<dd><p>A named list of integer vectors.  Each element <code>cs1</code>, <code>cs2</code>, …
is a confidence set of variable indices that achieves the target coverage.  If no sets
survive the filters, <code>sets</code> is <code>NULL</code>.</p></dd>

<dt><code>claimed</code></dt>
<dd><p>Numeric vector of the actual cumulative probabilities
("claimed coverage") for each returned set.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simple two-effect example</span></span></span>
<span class="r-in"><span><span class="va">pmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a correlation filter</span></span></span>
<span class="r-in"><span><span class="va">Rmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cs2</span> <span class="op">&lt;-</span> <span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span>, coverage <span class="op">=</span> <span class="fl">0.8</span>, Rmat <span class="op">=</span> <span class="va">Rmat</span>, cor_threshold <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yizeng Li, Wei Pan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

